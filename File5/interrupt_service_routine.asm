			.ORIG X1500
			
			ST R0 SAVER00
			ST R1 SAVER11
			ST R2 SAVER22
			ST R7 SAVER77
			LDI R0 KBDR
			LD R1 CONV
			ADD R0 R0 R1
			BRz ISL
			LEA R0 ANYLET
			BRnzp START
			LD R0 SAVER00
			LD R1 SAVER11
			LD R2 SAVER22
			LD R7 SAVER77
			RTI
			
ISL			LEA R0 LETL
			BRnzp START
DONE		LD R0 SAVER00
			LD R1 SAVER11
			LD R2 SAVER22
			LD R7 SAVER77
			RTI

	;TRAP X22
	;--------------------------------------------------
START		ST R7 SAVER7
			ST R0 SAVER0
			ST R1 SAVER1
			ST R2 SAVER2
			LD R0 LF
AGAIN2		LDI R1 DSR
			BRzp AGAIN2
			STI R0 DDR
			LD R0 SAVER0
LOOP		LDR R1 R0 #0
			BRz EOT22
AGAIN		LDI R2 DSR
			BRzp AGAIN
			STI R1 DDR
			ADD R0 R0 #1
			BRnzp LOOP
EOT22		LD R0 LF
AGAIN1		LDI R1 DSR
			BRzp AGAIN1
			STI R0 DDR
			LD R0 SAVER0
			LD R1 SAVER1
			LD R2 SAVER2
			LD R7 SAVER7
			BRnzp DONE
			
	;TRAPX21
	;------------------------------------------

			
LF			.FILL X000A	
SR			.FILL XFE00
ENINT		.FILL X4000
DSR			.FILL XFE04
DDR			.FILL XFE06

KBDR		.FILL XFE02
CONV		.FILL #-76
SAVER00		.BLKW 1
SAVER11		.BLKW 1
SAVER22		.BLKW 1
SAVER77		.BLKW 1
SAVER0		.BLKW 1
SAVER1		.BLKW 1
SAVER2		.BLKW 1
SAVER7		.BLKW 1
LETL		.STRINGZ "EE306: LC-3"
ANYLET		.STRINGZ "EE319K: ARM"

			.END